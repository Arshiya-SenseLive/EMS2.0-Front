<div class=" container-fluid">
  <!-- Header -->
  <div class="row align-items-center mb-4 dashboard-header">
    <!-- Left: Greeting -->
    <div class="col-12 col-md-6">
      <div class="header-left">
        <h3 class="m-0">Hello, {{ userName }}!</h3>
        <p class="m-0">Track your devices and efficiency in real time âš¡</p>
      </div>
    </div>

    <!-- Right: Actions -->
    <div class="col-12 col-md-6 mt-3 mt-md-0">
      <div class="header-actions justify-content-md-end">
        <button class="icon-btn" aria-label="Notifications">
          <mat-icon>notifications</mat-icon>
          <span class="notify-dot" aria-hidden="true"></span>
        </button>
        <button class="icon-btn" aria-label="Settings">
          <mat-icon>settings</mat-icon>
        </button>
      </div>
    </div>
  </div>



  <!-- FILTER TOGGLE + CURRENT BADGES -->
  <div class="row align-items-center mb-2">
  <!-- Left: Toggle -->
  <div class="col-auto">
    <button class="btn btn-toggle"
            (click)="toggleFilters()"
            [attr.aria-expanded]="showFilters"
            [attr.aria-controls]="'filterPanel'">
              <mat-icon class="me-1">filter_list</mat-icon>

      <span>{{ showFilters ? 'Hide Filters' : 'Show Filters' }}</span>
      <mat-icon class="chev ms-1"  [class.rotate]="showFilters">expand_more</mat-icon>
    </button>
  </div>

  <!-- Right: Current badges -->
  <div class="col d-flex justify-content-end">
    <div *ngIf="!showFilters" class="current-badges d-flex align-items-center flex-wrap">
      <span class="label me-2">Current:</span>

      <span class="badge-pill" *ngIf="filter.type === 'device'">Device</span>
      <span class="badge-pill" *ngIf="filter.type === 'group'">Group</span>

      <span class="badge-pill" *ngIf="filter.type === 'device' && filter.deviceId">
        {{ getDeviceName(filter.deviceId) }}
      </span>
      <span class="badge-pill" *ngIf="filter.type === 'group' && filter.groupId">
        {{ getGroupName(filter.groupId) }}
      </span>

      <span class="badge-pill">{{ getLabel(dataModeOptions, filter.mode) }}</span>
      <span class="badge-pill">{{ getLabel(timePeriodOptions, filter.period) }}</span>
    </div>
  </div>
</div>


  <!-- COLLAPSIBLE FILTER CARD -->
  <div id="filterPanel" class="filter-card mb-4 collapsible" [class.open]="showFilters">
    <div class="card-body">
      <div class="row align-items-end">
        <!-- Filter Type -->
        <div class="col-12 col-sm-6 col-md-4 col-lg-2">
          <label class="form-label">Filter Type</label>
          <app-select [(ngModel)]="filter.type" [items]="filterTypeOptions" displayKey="label" valueKey="value"
            placeholder="Select filter type" (selectionChange)="onFilterTypeChange($event)">
          </app-select>
        </div>

        <!-- Device -->
        <div class="col-12 col-sm-6 col-md-4 col-lg-2" *ngIf="filter.type === 'device'">
          <label class="form-label">Select Device</label>
          <app-select [(ngModel)]="filter.deviceId" [items]="deviceOptions" displayKey="name" valueKey="id"
            placeholder="Choose a device" (selectionChange)="onDeviceChange($event)">
          </app-select>
        </div>

        <!-- Group -->
        <div class="col-12 col-sm-6 col-md-4 col-lg-2" *ngIf="filter.type === 'group'">
          <label class="form-label">Select Group</label>
          <app-select [(ngModel)]="filter.groupId" [items]="groupOptions" displayKey="name" valueKey="id"
            placeholder="Choose a group" (selectionChange)="onGroupChange($event)">
          </app-select>
        </div>

        <!-- Data Mode -->
        <div class="col-12 col-sm-6 col-md-4 col-lg-2">
          <label class="form-label">Data Mode</label>
          <app-select [(ngModel)]="filter.mode" [items]="dataModeOptions" displayKey="label" valueKey="value"
            placeholder="Select mode" (selectionChange)="onModeChange($event)">
          </app-select>
        </div>

        <!-- Time Period -->
        <div class="col-12 col-sm-6 col-md-4 col-lg-2">
          <label class="form-label">Time Period</label>
          <app-select [(ngModel)]="filter.period" [items]="timePeriodOptions" displayKey="label" valueKey="value"
            placeholder="Select period" (selectionChange)="onPeriodChange($event)">
          </app-select>
        </div>

        <!-- Apply -->
        <div class="col-12 col-sm-6 col-md-4 col-lg-2 d-flex align-items-end">
          <button class="btn btn-apply w-100" (click)="applyFilters()">
            Apply
          </button>
        </div>
      </div>
    </div>
  </div>






  <!-- Cards -->
  <div class="row g-3">
    <div class="col-12 col-sm-6 col-lg-3">
      <div class="card text-center p-3">
        <span class="card-title">KVA</span>
        <h3>1,245.6 <small>kVA</small></h3>
        <p>Apparent Power</p>
      </div>
    </div>

    <div class="col-12 col-sm-6 col-lg-3">
      <div class="card text-center p-3">
        <span class="card-title">KWH</span>
        <h3>8,932.4 <small>kWh</small></h3>
        <p>Energy Consumption</p>
      </div>
    </div>

    <div class="col-12 col-sm-6 col-lg-3">
      <div class="card text-center p-3">
        <span class="card-title">KVAR</span>
        <h3>342.1 <small>kVAR</small></h3>
        <p>Reactive Power</p>
      </div>
    </div>

    <div class="col-12 col-sm-6 col-lg-3">
      <div class="card text-center p-3">
        <span class="card-title">PF</span>
        <h3>0.92</h3>
        <p>Power Factor</p>
      </div>
    </div>
  </div>

</div>